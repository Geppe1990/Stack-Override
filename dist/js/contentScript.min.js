var questionSelector=document.querySelector("[data-questionid]"),questionId=questionSelector?parseInt(questionSelector.dataset.questionid):null,question={},answer={},OPT={address:"https://api.stackexchange.com/2.2/questions/",parameters:"?order=desc&sort=activity&site=stackoverflow&filter=withbody",answers:"/answers"};function highlightCode(e){e=(new DOMParser).parseFromString(e,"text/html");return e.querySelectorAll("pre code").forEach(e=>{hljs.highlightBlock(e)}),e.body.innerHTML}function createModal(e,t){var s=new tingle.modal({footer:!1,stickyFooter:!1,closeMethods:["overlay","button","escape"],closeLabel:"Close"}),n='<hr/><h2 class="heading answer__title">Answer ('+t.score+") </h2>";e.acceptedAnswer&&(n='<hr/><div><h2 class="heading answer__title" >Answer</h2>&nbsp;<img class="check" src="'+chrome.extension.getURL("images/check.svg")+'" alt="Check icon"></div>'),s.setContent('<h1 class="heading">'+e.title+"</h1>"+e.body+n+t.body),s.open()}async function getContent(e,t){var s="question"==t?OPT.address+e+OPT.parameters:OPT.address+e+OPT.answers+OPT.parameters;try{const n=await fetch(s);return await n.json()}catch(e){console.error("Error:",e)}}function manageAnswers(e){var t=null,s=-1;e.items.forEach(e=>{e.score>s&&(s=e.score,t=e.body)}),t?(answer.body=highlightCode(t),answer.score=s):answer=null,question&&answer&&createModal(question,answer)}function manageQuestion(e){e&&(question.title=e.items[0].title||null,question.body=e.items[0].body?highlightCode(e.items[0].body):null,question.acceptedAnswer=!!e.items[0].accepted_answer_id,getContent(questionId,"answer").then(function(e){manageAnswers(e)}))}questionId&&getContent(questionId,"question").then(function(e){manageQuestion(e)});